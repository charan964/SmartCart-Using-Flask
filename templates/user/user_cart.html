{% extends "layout.html" %}
{% block content %}

<div class="container py-4">

    <h2 class="fw-bold mb-4"><i class="fa fa-cart-shopping"></i> My Cart</h2>

    {% if cart|length == 0 %}
        <div class="text-center p-5">
            <img src="https://cdn-icons-png.flaticon.com/512/2038/2038854.png" width="120">
            <h4 class="mt-3">Your cart is empty!</h4>
            <a href="/user/products" class="btn btn-primary mt-3">
                <i class="fa fa-store"></i> Shop Now
            </a>
        </div>
    {% else %}

    <div class="row">

        <!-- LEFT: CART ITEMS -->
        <div class="col-md-8">

            {% for pid, item in cart.items() %}
            <div class="card mb-3 shadow-sm p-3">

                <div class="d-flex align-items-center">

                    <!-- Product Image -->
                    <img src="/static/uploads/product_images/{{ item.image }}"
                         width="100" height="100"
                         class="rounded border me-3">

                    <!-- Product Details -->
                    <div class="flex-grow-1">

                        <h5 class="fw-bold">{{ item.name }}</h5>
                        <p class="text-muted mb-1">₹ {{ item.price }}</p>

                        <!-- Quantity Controls -->
                        <div class="d-flex align-items-center">

                            <a href="/user/cart/decrease/{{ pid }}"
                               class="btn btn-outline-secondary btn-sm">−</a>

                            <span class="mx-2 fw-bold">{{ item.quantity }}</span>

                            <a href="/user/cart/increase/{{ pid }}"
                               class="btn btn-outline-secondary btn-sm">+</a>

                        </div>

                    </div>

                    <!-- Right Side: Remove & Total -->
                    <div class="text-end">

                        <!-- Item Total -->
                        <h5 class="text-success fw-bold">
                            ₹ {{ item.price * item.quantity }}
                        </h5>

                        <!-- Remove Button -->
                        <a href="/user/cart/remove/{{ pid }}"
                           class="btn btn-danger btn-sm mt-2">
                            <i class="fa fa-trash"></i>
                        </a>

                    </div>

                </div>

            </div>
            {% endfor %}

        </div>

        <!-- RIGHT: PRICE DETAILS -->
        <div class="col-md-4">

            <div class="card shadow-sm p-3">

                <h4 class="fw-bold mb-3">Price Details</h4>

                <p class="d-flex justify-content-between">
                    <span>Total Items:</span>
                    <strong>{{ cart|length }}</strong>
                </p>

                <p class="d-flex justify-content-between">
                    <span>Total Price:</span>
                    <strong>₹ {{ grand_total }}</strong>
                </p>

                <hr>

                <a href="/user/checkout" class="btn btn-success btn-lg w-100 mt-2">
                    Proceed to Checkout <i class="fa fa-arrow-right ms-1"></i>
                </a>

            </div>

        </div>

    </div>

    {% endif %}

</div>

{% endblock %}
