{% extends "layout.html" %}
{% block content %}

<h2 class="page-title">All Products</h2>

<!-- SEARCH + FILTER BAR -->
<div class="filter-bar">
    
    <form method="GET" action="/admin/item-list" class="filter-form">
        <input type="text" name="search" placeholder="Search products..."
               value="{{ request.args.get('search','') }}" class="filter-input">

        <select name="category" class="filter-input">
            <option value="">All Categories</option>
            {% for cat in categories %}
                <option value="{{ cat.category }}"
                        {% if request.args.get('category') == cat.category %} selected {% endif %}>
                    {{ cat.category }}
                </option>
            {% endfor %}
        </select>

        <button type="submit" class="btn filter-btn">Search</button>
    </form>
</div>

<!-- PRODUCTS GRID -->
<div class="product-grid">

    {% for p in products %}
    <div class="product-card">

        <img src="/static/uploads/product_images/{{ p.image }}" 
             alt="{{ p.name }}" class="product-img">

        <h3 class="product-title">{{ p.name }}</h3>
        <p class="product-price">â‚¹{{ p.price }}</p>

        <div class="product-buttons">
            <a href="/admin/view-item/{{ p.product_id }}" class="btn btn-view">
                View
            </a>

            <a href="/admin/update-item/{{ p.product_id }}" class="btn btn-edit">
                Edit
            </a>

            <a href="/admin/delete-item/{{ p.product_id }}"
               onclick="return confirm('Are you sure you want to delete this product?')" 
               class="btn btn-delete">
                Delete
            </a>
        </div>

    </div>
    {% endfor %}

</div>


<style>

/* ---------- Page Title ---------- */
.page-title {
    text-align: center;
    font-size: 32px;
    margin-bottom: 20px;
}

/* ---------- Filter Bar ---------- */
.filter-bar {
    width: 90%;
    margin: 0 auto 25px auto;
    text-align: center;
}

.filter-form {
    display: flex;
    gap: 12px;
    justify-content: center;
    flex-wrap: wrap;
}

.filter-input {
    padding: 10px 14px;
    border-radius: 6px;
    border: 1px solid #bbb;
    font-size: 15px;
}

.filter-btn {
    padding: 10px 20px;
}

/* ---------- Products Grid ---------- */
.product-grid {
    width: 90%;
    margin: auto;
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 22px;
}

/* ---------- Product Card ---------- */
.product-card {
    background: white;
    border-radius: 12px;
    padding: 15px;
    text-align: center;
    box-shadow: 0 4px 14px rgba(0,0,0,0.1);
    transition: 0.3s;
}

.product-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 20px rgba(0,0,0,0.15);
}

.product-img {
    width: 100%;
    height: 180px;
    object-fit: cover;
    border-radius: 10px;
}

.product-title {
    font-size: 18px;
    margin: 10px 0 5px 0;
}

.product-price {
    font-size: 20px;
    font-weight: bold;
    color: #007b00;
}

/* ---------- Buttons ---------- */
.product-buttons {
    display: flex;
    justify-content: center;
    gap: 8px;
    margin-top: 12px;
}

.btn-view {
    background: #2196F3;
    color: white;
    padding: 6px 10px;
    border-radius: 6px;
}

.btn-edit {
    background: #FF9800;
    color: white;
    padding: 6px 10px;
    border-radius: 6px;
}

.btn-delete {
    background: #E53935;
    color: white;
    padding: 6px 10px;
    border-radius: 6px;
}

/* ---------- Responsive Design ---------- */
@media (max-width: 1200px) {
    .product-grid { grid-template-columns: repeat(3, 1fr); }
}

@media (max-width: 900px) {
    .product-grid { grid-template-columns: repeat(2, 1fr); }
}

@media (max-width: 520px) {
    .product-grid { grid-template-columns: repeat(1, 1fr); }

    .filter-form {
        flex-direction: column;
    }

    .filter-input {
        width: 100%;
    }
}

</style>

{% endblock %}
